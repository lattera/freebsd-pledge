#include <curtain.h>
#include <sys/param.h>

#include <sys/filio.h>

#include <termios.h>
#include <sys/ttycom.h>

#include <sys/socket.h>
#include <netinet/in.h>
#include <net/if.h>
#include <netinet6/in6_var.h>
#include <netinet6/nd6.h>
#include <sys/sockio.h>

#include <sys/soundcard.h>

#include <crypto/cryptodev.h>

#include <net/bpf.h>

const unsigned long curtain_ioctls_tty_basic[] = {
	TIOCSBRK,
	TIOCCBRK,
	TIOCSDTR,
	TIOCCDTR,
	TIOCGPGRP,
	TIOCSPGRP, /* XXX */
	TIOCGETD,
	TIOCGETA,
	TIOCSETA,
	TIOCSETAW,
	TIOCSETAF,
	TIOCNOTTY,
	TIOCSTOP,
	TIOCSTART,
	TIOCSCTTY,
	TIOCDRAIN,
	TIOCEXCL,
	TIOCNXCL,
	TIOCFLUSH,
	TIOCGWINSZ,
	TIOCSWINSZ,
	FIODGNAME,
	-1
};

const unsigned long curtain_ioctls_tty_pts[] = {
	TIOCPKT,
	TIOCGPTN,
	TIOCPTMASTER,
	-1
};


const unsigned long curtain_ioctls_net_basic[] = {
	-1
};

const unsigned long curtain_ioctls_net_route[] = {
	SIOCGIFDESCR,
	SIOCGIFFLAGS,
	SIOCGIFMETRIC,
	SIOCGIFCONF,
	SIOCGIFFIB,
	SIOCGIFMTU,
	SIOCGIFMETRIC,
	SIOCGIFCAP,
	SIOCGIFGROUP,
	SIOCGIFINDEX,
	SIOCGIFSTATUS,
	SIOCGIFMEDIA,
#ifdef AF_INET
	SIOCGIFADDR,
	SIOCGIFBRDADDR,
	SIOCGIFDSTADDR,
	SIOCGIFNETMASK,
	SIOCGIFALIAS,
	SIOCGHWADDR,
#endif
#ifdef AF_INET6
	SIOCGIFAFLAG_IN6,
	SIOCGIFALIFETIME_IN6,
	SIOCGDEFIFACE_IN6,
	SIOCGIFINFO_IN6,
#endif
#if 0
	SIOCGIFPSRCADDR,
	SIOCGIFPDSTADDR,
	SIOCGIFDATA,
	SIOCGIFPHYS,
	SIOCGIFGENERIC,
	SIOCGIFMAC,
	SIOCGIFFIB,
	SIOCGIFGMEMB,
	SIOCGIFXMEDIA,
	SIOCGIFDOWNREASON,
#endif
	-1
};


const unsigned long curtain_ioctls_oss[] = {
	AIONWRITE,
	AIOGSIZE,
	AIOSSIZE,
	AIOGFMT,
	AIOSFMT,
	AIOGMIX,
	AIOSMIX,
	AIOSTOP,
	AIOSYNC,
	AIOGCAP,
	SNDCTL_SEQ_RESET,
	SNDCTL_SEQ_SYNC,
	SNDCTL_SYNTH_INFO,
	SNDCTL_SEQ_CTRLRATE,
	SNDCTL_SEQ_GETOUTCOUNT,
	SNDCTL_SEQ_GETINCOUNT,
	SNDCTL_SEQ_PERCMODE,
	SNDCTL_FM_LOAD_INSTR,
	SNDCTL_SEQ_TESTMIDI,
	SNDCTL_SEQ_RESETSAMPLES,
	SNDCTL_SEQ_NRSYNTHS,
	SNDCTL_SEQ_NRMIDIS,
	SNDCTL_MIDI_INFO,
	SNDCTL_SEQ_THRESHOLD,
	SNDCTL_SEQ_TRESHOLD,
	SNDCTL_SYNTH_MEMAVL,
	SNDCTL_FM_4OP_ENABLE,
	SNDCTL_PMGR_ACCESS,
	SNDCTL_SEQ_PANIC,
	SNDCTL_SEQ_OUTOFBAND,
	SNDCTL_SEQ_GETTIME,
	SNDCTL_TMR_TIMEBASE,
	SNDCTL_TMR_START,
	SNDCTL_TMR_STOP,
	SNDCTL_TMR_CONTINUE,
	SNDCTL_TMR_TEMPO,
	SNDCTL_TMR_SOURCE,
	SNDCTL_TMR_METRONOME,
	SNDCTL_TMR_SELECT,
	SNDCTL_PMGR_IFACE,
	SNDCTL_MIDI_PRETIME,
	SNDCTL_MIDI_MPUMODE,
	SNDCTL_MIDI_MPUCMD,
	MIOSPASSTHRU,
	MIOGPASSTHRU,
	SNDCTL_DSP_HALT,
	SNDCTL_DSP_RESET,
	SNDCTL_DSP_SYNC,
	SNDCTL_DSP_SPEED,
	SNDCTL_DSP_STEREO,
	SNDCTL_DSP_GETBLKSIZE,
	SNDCTL_DSP_SETBLKSIZE,
	SNDCTL_DSP_SETFMT,
	SOUND_PCM_WRITE_CHANNELS,
	SNDCTL_DSP_CHANNELS,
	SOUND_PCM_WRITE_FILTER,
	SNDCTL_DSP_POST,
	SNDCTL_DSP_SUBDIVIDE,
	SNDCTL_DSP_SETFRAGMENT,
	SNDCTL_DSP_GETFMTS,
	SNDCTL_DSP_GETOSPACE,
	SNDCTL_DSP_GETISPACE,
	SNDCTL_DSP_NONBLOCK,
	SNDCTL_DSP_GETCAPS,
	SNDCTL_DSP_GETTRIGGER,
	SNDCTL_DSP_SETTRIGGER,
	SNDCTL_DSP_GETIPTR,
	SNDCTL_DSP_GETOPTR,
	SNDCTL_DSP_MAPINBUF,
	SNDCTL_DSP_MAPOUTBUF,
	SNDCTL_DSP_SETSYNCRO,
	SNDCTL_DSP_SETDUPLEX,
	SNDCTL_DSP_GETODELAY,
	SOUND_PCM_READ_RATE,
	SOUND_PCM_READ_CHANNELS,
	SOUND_PCM_READ_BITS,
	SOUND_PCM_READ_FILTER,
	SNDCTL_COPR_RESET,
	SNDCTL_COPR_LOAD,
	SNDCTL_COPR_RDATA,
	SNDCTL_COPR_RCODE,
	SNDCTL_COPR_WDATA,
	SNDCTL_COPR_WCODE,
	SNDCTL_COPR_RUN,
	SNDCTL_COPR_HALT,
	SNDCTL_COPR_SENDMSG,
	SNDCTL_COPR_RCVMSG,
	SOUND_MIXER_READ_VOLUME,
	SOUND_MIXER_READ_BASS,
	SOUND_MIXER_READ_TREBLE,
	SOUND_MIXER_READ_SYNTH,
	SOUND_MIXER_READ_PCM,
	SOUND_MIXER_READ_SPEAKER,
	SOUND_MIXER_READ_LINE,
	SOUND_MIXER_READ_MIC,
	SOUND_MIXER_READ_CD,
	SOUND_MIXER_READ_IMIX,
	SOUND_MIXER_READ_ALTPCM,
	SOUND_MIXER_READ_RECLEV,
	SOUND_MIXER_READ_IGAIN,
	SOUND_MIXER_READ_OGAIN,
	SOUND_MIXER_READ_LINE1,
	SOUND_MIXER_READ_LINE2,
	SOUND_MIXER_READ_LINE3,
	SOUND_MIXER_READ_DIGITAL1,
	SOUND_MIXER_READ_DIGITAL2,
	SOUND_MIXER_READ_DIGITAL3,
	SOUND_MIXER_READ_PHONEIN,
	SOUND_MIXER_READ_PHONEOUT,
	SOUND_MIXER_READ_RADIO,
	SOUND_MIXER_READ_VIDEO,
	SOUND_MIXER_READ_MONITOR,
	SOUND_MIXER_READ_MUTE,
	SOUND_MIXER_READ_ENHANCE,
	SOUND_MIXER_READ_LOUD,
	SOUND_MIXER_READ_RECSRC,
	SOUND_MIXER_READ_DEVMASK,
	SOUND_MIXER_READ_RECMASK,
	SOUND_MIXER_READ_STEREODEVS,
	SOUND_MIXER_READ_CAPS,
	SOUND_MIXER_WRITE_VOLUME,
	SOUND_MIXER_WRITE_BASS,
	SOUND_MIXER_WRITE_TREBLE,
	SOUND_MIXER_WRITE_SYNTH,
	SOUND_MIXER_WRITE_PCM,
	SOUND_MIXER_WRITE_SPEAKER,
	SOUND_MIXER_WRITE_LINE,
	SOUND_MIXER_WRITE_MIC,
	SOUND_MIXER_WRITE_CD,
	SOUND_MIXER_WRITE_IMIX,
	SOUND_MIXER_WRITE_ALTPCM,
	SOUND_MIXER_WRITE_RECLEV,
	SOUND_MIXER_WRITE_IGAIN,
	SOUND_MIXER_WRITE_OGAIN,
	SOUND_MIXER_WRITE_LINE1,
	SOUND_MIXER_WRITE_LINE2,
	SOUND_MIXER_WRITE_LINE3,
	SOUND_MIXER_WRITE_DIGITAL1,
	SOUND_MIXER_WRITE_DIGITAL2,
	SOUND_MIXER_WRITE_DIGITAL3,
	SOUND_MIXER_WRITE_PHONEIN,
	SOUND_MIXER_WRITE_PHONEOUT,
	SOUND_MIXER_WRITE_RADIO,
	SOUND_MIXER_WRITE_VIDEO,
	SOUND_MIXER_WRITE_MONITOR,
	SOUND_MIXER_WRITE_MUTE,
	SOUND_MIXER_WRITE_ENHANCE,
	SOUND_MIXER_WRITE_LOUD,
	SOUND_MIXER_WRITE_RECSRC,
	SOUND_MIXER_INFO,
	SNDCTL_DSP_SAMPLESIZE,
	SOUND_PCM_WRITE_BITS,
	SOUND_PCM_SETFMT,
	SOUND_PCM_WRITE_RATE,
	SOUND_PCM_POST,
	SOUND_PCM_RESET,
	SOUND_PCM_SYNC,
	SOUND_PCM_SUBDIVIDE,
	SOUND_PCM_SETFRAGMENT,
	SOUND_PCM_GETFMTS,
	SOUND_PCM_GETOSPACE,
	SOUND_PCM_GETISPACE,
	SOUND_PCM_NONBLOCK,
	SOUND_PCM_GETCAPS,
	SOUND_PCM_GETTRIGGER,
	SOUND_PCM_SETTRIGGER,
	SOUND_PCM_SETSYNCRO,
	SOUND_PCM_GETIPTR,
	SOUND_PCM_GETOPTR,
	SOUND_PCM_MAPINBUF,
	SOUND_PCM_MAPOUTBUF,
	SNDCTL_DSP_GETPLAYVOL,
	SNDCTL_DSP_SETPLAYVOL,
	SNDCTL_DSP_GETERROR,
	SNDCTL_DSP_SYNCGROUP,
	SNDCTL_DSP_SYNCSTART,
	SNDCTL_DSP_COOKEDMODE,
	SNDCTL_DSP_SILENCE,
	SNDCTL_DSP_SKIP,
	SNDCTL_DSP_HALT_INPUT,
	SNDCTL_DSP_RESET_INPUT,
	SNDCTL_DSP_HALT_OUTPUT,
	SNDCTL_DSP_RESET_OUTPUT,
	SNDCTL_DSP_LOW_WATER,
	SNDCTL_DSP_CURRENT_IPTR,
	SNDCTL_DSP_CURRENT_OPTR,
	SNDCTL_DSP_GET_RECSRC_NAMES,
	SNDCTL_DSP_GET_RECSRC,
	SNDCTL_DSP_SET_RECSRC,
	SNDCTL_DSP_GET_PLAYTGT_NAMES,
	SNDCTL_DSP_GET_PLAYTGT,
	SNDCTL_DSP_SET_PLAYTGT,
	SNDCTL_DSP_GETRECVOL,
	SNDCTL_DSP_SETRECVOL,
	SNDCTL_DSP_GET_CHNORDER,
	SNDCTL_DSP_SET_CHNORDER,
	SNDCTL_DSP_GETIPEAKS,
	SNDCTL_DSP_GETOPEAKS,
	SNDCTL_DSP_POLICY,
	SNDCTL_DSP_GETCHANNELMASK,
	SNDCTL_DSP_BIND_CHANNEL,
	OSS_GETVERSION,
	SNDCTL_SYSINFO,
	OSS_SYSINFO,
	SNDCTL_MIX_NRMIX,
	SNDCTL_MIX_NREXT,
	SNDCTL_MIX_EXTINFO,
	SNDCTL_MIX_READ,
	SNDCTL_MIX_WRITE,
	SNDCTL_AUDIOINFO,
	SNDCTL_MIX_ENUMINFO,
	SNDCTL_MIDIINFO,
	SNDCTL_MIXERINFO,
	SNDCTL_CARDINFO,
	SNDCTL_ENGINEINFO,
	SNDCTL_AUDIOINFO_EX,
	SNDCTL_SETSONG,
	SNDCTL_GETSONG,
	SNDCTL_SETNAME,
	SNDCTL_SETLABEL,
	SNDCTL_GETLABEL,
	-1
};

const unsigned long curtain_ioctls_cryptodev[] = {
	CIOCGSESSION,
	CIOCFSESSION,
	CIOCCRYPT,
	CIOCGSESSION2,
	CIOCFINDDEV,
	CIOCCRYPTAEAD,
	-1
};

const unsigned long curtain_ioctls_bpf_all[] = {
	BIOCGBLEN,
	BIOCSBLEN,
	BIOCSETF,
	BIOCFLUSH,
	BIOCPROMISC,
	BIOCGDLT,
	BIOCGETIF,
	BIOCSETIF,
	BIOCSRTIMEOUT,
	BIOCGRTIMEOUT,
	BIOCGSTATS,
	BIOCIMMEDIATE,
	BIOCVERSION,
	BIOCGRSIG,
	BIOCSRSIG,
	BIOCGHDRCMPLT,
	BIOCSHDRCMPLT,
	BIOCGDIRECTION,
	BIOCSDIRECTION,
	BIOCSDLT,
	BIOCGDLTLIST,
	BIOCLOCK,
	BIOCSETWF,
	BIOCFEEDBACK,
	BIOCGETBUFMODE,
	BIOCSETBUFMODE,
	BIOCGETZMAX,
	BIOCROTZBUF,
	BIOCSETZBUF,
	BIOCSETFNR,
	BIOCGTSTAMP,
	BIOCSTSTAMP,
	-1
};
